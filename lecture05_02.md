# 第5回課題_02

## 課題内容（サンプルアプリケーションがunicorn+nginxでの起動から、puma+nginxでの起動に変更された）

- EC2 上にサンプルアプリケーションをデプロイして、動作させてください。
  - サンプルは第3回で案内済みのものを使ってください。
  - まずは組み込みサーバーだけで、動作したらサーバーアプリケーションを分けて動くかチャレンジしてみましょう。必要な知識や手順は授業の中でお伝えしています。
- 動作したら、ELB(ALB)を追加してみましょう。
- ELB を加えて動作が確認できたら、さらに S3 を追加してみましょう。S3 をどのように使うかはお任せします。
- ここまでが問題無く動作したら、その環境を構成図に書き起こしてください。
  - 構成図の書き方動画をポータルサイトに公開しています。
- 以上の結果を、正しく動作したことを示す資料（画像など）を添えて報告してください。

---

## EC2上でサンプルサプリケーションをデプロイ

- bin/devで実行<br>![01](l05_02/01.png)
- pumaをsystemdで起動<br>![02](l05_02/02.png)
- Nginxの単体起動確認<br>![03](l05_02/03.png)
- Nginxとpumaを組み合わせてデプロイ<br>![04](l05_02/04.png)

---

## ELB（ALB）の追加

- ALBの作成<br>![05](l05_02/05.png)
- ターゲットグループのヘルスステータス<br>![06](l05_02/06.png)
- ALBのDNS名でアクセスし動作確認完了<br>![07](l05_02/07.png)

---

## S3の追加（サンプルアプリの画像保存先として使用）

- S3の作成<br>![08](l05_02/08.png)
- EC2にS3への接続を許可するIAMロール追加<br>![09](l05_02/09.png)
- IAMロールの内容（AmazonS3FullAcces付与）<br>![10](l05_02/10.png)
- S3に画像を保存<br>![11](l05_02/11.png)
- S3内に画像がある事を確認<br>![12](l05_02/12.png)

---

## 構成図の作成

![構成図](l05_02/構成図.png)

---

## Railsアプリケーションの動作環境

ruby

```bash
3.2.3
```

Bundler

```bash
2.3.14
```

Rails

```bash
7.1.3.2
```

Node

```bash
v17.9.1
```

yarn

```bash
1.22.19
```


---

## 課題を終えた感想

Railsのサンプルアプリケーションの仕様が変更になった事もあり、新しいサンプルアプリケーションを使用して再度第5回の課題を行った。
以前、旧サンプルアプリケーションで本課題を実行した際はエラーのログをチェックするというよりGoogle検索で似た事例がないか確認して問題を解決するという行き当たりばったりな方法で課題を進めていたが、今回はログでエラーの内容を確認して対応するという本来あるべき手順を何度も重ねることで課題を達成できた。今後もエラーの読み込みをしっかり行うようにしたい。
